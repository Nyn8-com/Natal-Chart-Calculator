<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h2 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .input-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #2a5298;
        }

        .form-group input, .form-group select {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #2a5298;
        }

        .calculate-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.3s;
            width: 100%;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
        }

        .results-section {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .chart-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 30px;
        }

        .chart-wheel {
            flex: 1;
            min-width: 400px;
            position: relative;
        }

        .planet-data {
            flex: 1;
            min-width: 300px;
        }

        .chart-svg {
            width: 100%;
            height: 400px;
            border: 2px solid #2a5298;
            border-radius: 50%;
            background: radial-gradient(circle, #f8f9ff, #e8eeff);
        }

        .planet-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .planet-table th,
        .planet-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .planet-table th {
            background: #2a5298;
            color: white;
        }

        .planet-table tr:hover {
            background: #f5f5f5;
        }

        .interpretations {
            margin-top: 30px;
        }

        .interpretation-card {
            background: #f8f9ff;
            border-left: 4px solid #2a5298;
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 8px;
        }

        .interpretation-card h3 {
            color: #2a5298;
            margin-bottom: 10px;
        }

        .error-message {
            background: #ffe6e6;
            color: #d32f2f;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            border-left: 4px solid #d32f2f;
        }

        .loading {
            text-align: center;
            padding: 20px;
            display: none;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2a5298;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h2 {
                font-size: 2rem;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                flex-direction: column;
            }
            
            .chart-wheel {
                min-width: auto;
            }
            
            .chart-svg {
                height: 300px;
            }
        }

        .zodiac-signs {
            font-size: 14px;
            font-weight: bold;
        }

        .planet-symbol {
            font-size: 18px;
            font-weight: bold;
            color: #2a5298;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h2>🌟 Natal Chart Calculator 🌟</h2>
            <p>Discover your cosmic blueprint with precise astrological calculations</p>
        </div>

        <div class="input-section">
            <h2>Birth Information</h2>
            <div class="error-message" id="errorMessage"></div>
            
            <form id="chartForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="birthDate">Birth Date:</label>
                        <input type="date" id="birthDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="birthTime">Birth Time:</label>
                        <input type="time" id="birthTime" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="birthLocation">Birth Location (City, Country):</label>
                        <input type="text" id="birthLocation" placeholder="e.g., New York, NY, USA" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="timezone">Time Zone (UTC offset):</label>
                        <select id="timezone">
                            <option value="-12">UTC-12</option>
                            <option value="-11">UTC-11</option>
                            <option value="-10">UTC-10</option>
                            <option value="-9">UTC-9</option>
                            <option value="-8">UTC-8</option>
                            <option value="-7">UTC-7</option>
                            <option value="-6">UTC-6</option>
                            <option value="-5" selected>UTC-5</option>
                            <option value="-4">UTC-4</option>
                            <option value="-3">UTC-3</option>
                            <option value="-2">UTC-2</option>
                            <option value="-1">UTC-1</option>
                            <option value="0">UTC+0</option>
                            <option value="1">UTC+1</option>
                            <option value="2">UTC+2</option>
                            <option value="3">UTC+3</option>
                            <option value="4">UTC+4</option>
                            <option value="5">UTC+5</option>
                            <option value="6">UTC+6</option>
                            <option value="7">UTC+7</option>
                            <option value="8">UTC+8</option>
                            <option value="9">UTC+9</option>
                            <option value="10">UTC+10</option>
                            <option value="11">UTC+11</option>
                            <option value="12">UTC+12</option>
                        </select>
                    </div>
                </div>
                <body>

  <div id="linkContainer">
    <!-- Link will be added here -->
  </div>

  <button onclick="showLink()">Get Link</button>

  <script>
    function showLink() {
      const div = document.getElementById("linkContainer");
      div.innerHTML = '<a href="https://aicalculator.in" target="_blank">Go to AI Calculator</a>';
    }
  </script>

</body>
                
                <button type="submit" class="calculate-btn">Calculate Natal Chart</button>
            </form>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Calculating your natal chart...</p>
            </div>
        </div>

        <div class="results-section" id="resultsSection">
            <h2>Your Natal Chart</h2>
            
            <div class="chart-container">
                <div class="chart-wheel">
                    <svg class="chart-svg" id="chartSvg" viewBox="0 0 400 400">
                        <!-- Chart will be drawn here -->
                    </svg>
                </div>
                
                <div class="planet-data">
                    <h3>Planetary Positions</h3>
                    <table class="planet-table" id="planetTable">
                        <thead>
                            <tr>
                                <th>Planet</th>
                                <th>Sign</th>
                                <th>Degree</th>
                                <th>House</th>
                            </tr>
                        </thead>
                        <tbody id="planetTableBody">
                            <!-- Planet data will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="interpretations" id="interpretations">
                <!-- Interpretations will be inserted here -->
            </div>
        </div>
    </div>

    <script>
        // Astronomical and Astrological Calculation Engine
        class NatalChartCalculator {
            constructor() {
                // Zodiac signs and their symbols
                this.zodiacSigns = [
                    { name: 'Aries', symbol: '♈', element: 'Fire', quality: 'Cardinal' },
                    { name: 'Taurus', symbol: '♉', element: 'Earth', quality: 'Fixed' },
                    { name: 'Gemini', symbol: '♊', element: 'Air', quality: 'Mutable' },
                    { name: 'Cancer', symbol: '♋', element: 'Water', quality: 'Cardinal' },
                    { name: 'Leo', symbol: '♌', element: 'Fire', quality: 'Fixed' },
                    { name: 'Virgo', symbol: '♍', element: 'Earth', quality: 'Mutable' },
                    { name: 'Libra', symbol: '♎', element: 'Air', quality: 'Cardinal' },
                    { name: 'Scorpio', symbol: '♏', element: 'Water', quality: 'Fixed' },
                    { name: 'Sagittarius', symbol: '♐', element: 'Fire', quality: 'Mutable' },
                    { name: 'Capricorn', symbol: '♑', element: 'Earth', quality: 'Cardinal' },
                    { name: 'Aquarius', symbol: '♒', element: 'Air', quality: 'Fixed' },
                    { name: 'Pisces', symbol: '♓', element: 'Water', quality: 'Mutable' }
                ];

                // Planet symbols and meanings
                this.planets = {
                    'Sun': { symbol: '☉', color: '#FFA500' },
                    'Moon': { symbol: '☽', color: '#C0C0C0' },
                    'Mercury': { symbol: '☿', color: '#87CEEB' },
                    'Venus': { symbol: '♀', color: '#FFB6C1' },
                    'Mars': { symbol: '♂', color: '#FF4500' },
                    'Jupiter': { symbol: '♃', color: '#FF8C00' },
                    'Saturn': { symbol: '♄', color: '#8B4513' },
                    'Uranus': { symbol: '♅', color: '#4169E1' },
                    'Neptune': { symbol: '♆', color: '#0000FF' },
                    'Pluto': { symbol: '♇', color: '#800080' }
                };
            }

            // Convert degrees to radians
            toRadians(degrees) {
                return degrees * (Math.PI / 180);
            }

            // Convert radians to degrees
            toDegrees(radians) {
                return radians * (180 / Math.PI);
            }

            // Calculate Julian Day Number
            calculateJulianDay(year, month, day, hour, minute, timezoneOffset) {
                // Convert to UTC
                const utcHour = hour - timezoneOffset;
                const decimalTime = utcHour + (minute / 60);
                
                // Julian Day calculation
                let a = Math.floor((14 - month) / 12);
                let y = year - a;
                let m = month + 12 * a - 3;
                
                let jd = day + Math.floor((153 * m + 2) / 5) + 365 * y + Math.floor(y / 4) - Math.floor(y / 100) + Math.floor(y / 400) + 1721119;
                
                // Add time fraction
                jd += (decimalTime - 12) / 24;
                
                return jd;
            }

            // Calculate Greenwich Sidereal Time
            calculateGST(jd) {
                const t = (jd - 2451545.0) / 36525.0;
                let gst = 280.46061837 + 360.98564736629 * (jd - 2451545.0) + 0.000387933 * t * t - t * t * t / 38710000.0;
                
                // Normalize to 0-360 degrees
                gst = gst % 360;
                if (gst < 0) gst += 360;
                
                return gst;
            }

            // Calculate Local Sidereal Time
            calculateLST(gst, longitude) {
                let lst = gst + longitude;
                lst = lst % 360;
                if (lst < 0) lst += 360;
                return lst;
            }

            // Simplified planetary position calculation
            calculatePlanetPosition(planet, jd) {
                const t = (jd - 2451545.0) / 36525.0;
                let longitude = 0;

                // Simplified orbital elements (this is a basic approximation)
                switch (planet) {
                    case 'Sun':
                        longitude = 280.466 + 36000.769 * t;
                        break;
                    case 'Moon':
                        longitude = 218.316 + 481267.881 * t;
                        break;
                    case 'Mercury':
                        longitude = 252.25 + 149472.69 * t;
                        break;
                    case 'Venus':
                        longitude = 181.98 + 58517.81 * t;
                        break;
                    case 'Mars':
                        longitude = 355.43 + 19140.30 * t;
                        break;
                    case 'Jupiter':
                        longitude = 34.35 + 3034.91 * t;
                        break;
                    case 'Saturn':
                        longitude = 50.08 + 1222.11 * t;
                        break;
                    case 'Uranus':
                        longitude = 314.05 + 428.46 * t;
                        break;
                    case 'Neptune':
                        longitude = 304.35 + 218.46 * t;
                        break;
                    case 'Pluto':
                        longitude = 238.96 + 145.18 * t;
                        break;
                }

                // Normalize longitude
                longitude = longitude % 360;
                if (longitude < 0) longitude += 360;

                return longitude;
            }

            // Calculate Ascendant
            calculateAscendant(lst, latitude) {
                const latRad = this.toRadians(latitude);
                const lstRad = this.toRadians(lst);
                
                // Simplified ascendant calculation
                let asc = Math.atan2(-Math.cos(lstRad), Math.sin(lstRad) * Math.tan(latRad));
                asc = this.toDegrees(asc);
                
                if (asc < 0) asc += 360;
                
                return asc;
            }

            // Calculate house cusps using Placidus system (simplified)
            calculateHouses(ascendant, lst, latitude) {
                const houses = [];
                const latRad = this.toRadians(latitude);
                
                // House 1 is the Ascendant
                houses[0] = ascendant;
                
                // Calculate other house cusps (simplified Placidus approximation)
                for (let i = 1; i < 12; i++) {
                    houses[i] = (ascendant + (i * 30)) % 360;
                }
                
                return houses;
            }

            // Determine which zodiac sign a degree falls into
            getZodiacSign(longitude) {
                const signIndex = Math.floor(longitude / 30);
                const degree = longitude % 30;
                return {
                    sign: this.zodiacSigns[signIndex],
                    degree: degree
                };
            }

            // Determine which house a planet is in
            getPlanetHouse(planetLongitude, houseCusps) {
                for (let i = 0; i < 12; i++) {
                    const currentHouse = houseCusps[i];
                    const nextHouse = houseCusps[(i + 1) % 12];
                    
                    if (nextHouse > currentHouse) {
                        if (planetLongitude >= currentHouse && planetLongitude < nextHouse) {
                            return i + 1;
                        }
                    } else {
                        if (planetLongitude >= currentHouse || planetLongitude < nextHouse) {
                            return i + 1;
                        }
                    }
                }
                return 1; // Default to first house
            }

            // Main calculation function
            calculateNatalChart(birthData) {
                const { year, month, day, hour, minute, latitude, longitude, timezoneOffset } = birthData;
                
                // Calculate Julian Day
                const jd = this.calculateJulianDay(year, month, day, hour, minute, timezoneOffset);
                
                // Calculate sidereal time
                const gst = this.calculateGST(jd);
                const lst = this.calculateLST(gst, longitude);
                
                // Calculate Ascendant
                const ascendant = this.calculateAscendant(lst, latitude);
                
                // Calculate house cusps
                const houses = this.calculateHouses(ascendant, lst, latitude);
                
                // Calculate planet positions
                const planetPositions = {};
                Object.keys(this.planets).forEach(planet => {
                    const planetLongitude = this.calculatePlanetPosition(planet, jd);
                    const zodiacInfo = this.getZodiacSign(planetLongitude);
                    const house = this.getPlanetHouse(planetLongitude, houses);
                    
                    planetPositions[planet] = {
                        longitude: planetLongitude,
                        sign: zodiacInfo.sign,
                        degree: zodiacInfo.degree,
                        house: house
                    };
                });
                
                return {
                    ascendant: ascendant,
                    houses: houses,
                    planets: planetPositions,
                    ascendantSign: this.getZodiacSign(ascendant)
                };
            }
        }

        // Chart Renderer Class
        class ChartRenderer {
            constructor(svgElement) {
                this.svg = svgElement;
                this.centerX = 200;
                this.centerY = 200;
                this.outerRadius = 180;
                this.innerRadius = 120;
                this.signRadius = 150;
                this.planetRadius = 100;
            }

            clearChart() {
                this.svg.innerHTML = '';
            }

            drawChart(chartData) {
                this.clearChart();
                
                // Draw outer circle
                this.drawCircle(this.centerX, this.centerY, this.outerRadius, 'none', '#2a5298', 2);
                
                // Draw inner circle
                this.drawCircle(this.centerX, this.centerY, this.innerRadius, 'none', '#2a5298', 1);
                
                // Draw zodiac signs
                this.drawZodiacSigns();
                
                // Draw house divisions
                this.drawHouses(chartData.houses);
                
                // Draw planets
                this.drawPlanets(chartData.planets);
                
                // Mark Ascendant
                this.markAscendant(chartData.ascendant);
            }

            drawCircle(cx, cy, r, fill, stroke, strokeWidth) {
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', cx);
                circle.setAttribute('cy', cy);
                circle.setAttribute('r', r);
                circle.setAttribute('fill', fill);
                circle.setAttribute('stroke', stroke);
                circle.setAttribute('stroke-width', strokeWidth);
                this.svg.appendChild(circle);
            }

            drawLine(x1, y1, x2, y2, stroke, strokeWidth) {
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', x1);
                line.setAttribute('y1', y1);
                line.setAttribute('x2', x2);
                line.setAttribute('y2', y2);
                line.setAttribute('stroke', stroke);
                line.setAttribute('stroke-width', strokeWidth);
                this.svg.appendChild(line);
            }

            drawText(x, y, text, fontSize, fill, textAnchor = 'middle') {
                const textElement = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                textElement.setAttribute('x', x);
                textElement.setAttribute('y', y);
                textElement.setAttribute('font-size', fontSize);
                textElement.setAttribute('fill', fill);
                textElement.setAttribute('text-anchor', textAnchor);
                textElement.setAttribute('dominant-baseline', 'central');
                textElement.textContent = text;
                this.svg.appendChild(textElement);
            }

            drawZodiacSigns() {
                const calculator = new NatalChartCalculator();
                for (let i = 0; i < 12; i++) {
                    const angle = (i * 30) - 90; // Start from Aries at top
                    const radian = (angle * Math.PI) / 180;
                    const x = this.centerX + Math.cos(radian) * this.signRadius;
                    const y = this.centerY + Math.sin(radian) * this.signRadius;
                    
                    this.drawText(x, y, calculator.zodiacSigns[i].symbol, 16, '#2a5298');
                }
            }

            drawHouses(houses) {
                for (let i = 0; i < 12; i++) {
                    const angle = houses[i] - 90;
                    const radian = (angle * Math.PI) / 180;
                    
                    const x1 = this.centerX + Math.cos(radian) * this.innerRadius;
                    const y1 = this.centerY + Math.sin(radian) * this.innerRadius;
                    const x2 = this.centerX + Math.cos(radian) * this.outerRadius;
                    const y2 = this.centerY + Math.sin(radian) * this.outerRadius;
                    
                    this.drawLine(x1, y1, x2, y2, '#cccccc', 1);
                    
                    // House numbers
                    const textAngle = (houses[i] + 15) - 90;
                    const textRadian = (textAngle * Math.PI) / 180;
                    const textX = this.centerX + Math.cos(textRadian) * (this.innerRadius + 15);
                    const textY = this.centerY + Math.sin(textRadian) * (this.innerRadius + 15);
                    
                    this.drawText(textX, textY, (i + 1).toString(), 12, '#666666');
                }
            }

            drawPlanets(planets) {
                const calculator = new NatalChartCalculator();
                Object.keys(planets).forEach(planetName => {
                    const planet = planets[planetName];
                    const angle = planet.longitude - 90;
                    const radian = (angle * Math.PI) / 180;
                    
                    const x = this.centerX + Math.cos(radian) * this.planetRadius;
                    const y = this.centerY + Math.sin(radian) * this.planetRadius;
                    
                    // Draw planet symbol
                    this.drawText(x, y, calculator.planets[planetName].symbol, 14, calculator.planets[planetName].color);
                });
            }

            markAscendant(ascendant) {
                const angle = ascendant - 90;
                const radian = (angle * Math.PI) / 180;
                
                const x1 = this.centerX + Math.cos(radian) * (this.outerRadius - 10);
                const y1 = this.centerY + Math.sin(radian) * (this.outerRadius - 10);
                const x2 = this.centerX + Math.cos(radian) * (this.outerRadius + 10);
                const y2 = this.centerY + Math.sin(radian) * (this.outerRadius + 10);
                
                this.drawLine(x1, y1, x2, y2, '#FF0000', 3);
                
                // AC label
                const textX = this.centerX + Math.cos(radian) * (this.outerRadius + 25);
                const textY = this.centerY + Math.sin(radian) * (this.outerRadius + 25);
                this.drawText(textX, textY, 'AC', 12, '#FF0000');
            }
        }

        // Interpretation Generator Class
        class InterpretationGenerator {
            constructor() {
                this.interpretations = {
                    sun: {
                        'Aries': 'You are a natural born leader with abundant energy and enthusiasm. Your pioneering spirit drives you to initiate new projects and adventures.',
                        'Taurus': 'You possess a steady, reliable nature with a deep appreciation for beauty and comfort. Patience and determination are your greatest strengths.',
                        'Gemini': 'Your curious mind and versatile nature make you an excellent communicator. You thrive on variety and intellectual stimulation.',
                        'Cancer': 'You are deeply intuitive and nurturing, with strong ties to home and family. Your emotional intelligence guides your decisions.',
                        'Leo': 'You radiate confidence and creativity, naturally drawing others to your magnetic personality. Self-expression is vital to your well-being.',
                        'Virgo': 'Your analytical mind and attention to detail make you highly practical and efficient. You find fulfillment in service to others.',
                        'Libra': 'You seek harmony and balance in all aspects of life. Your diplomatic nature and sense of justice make you a natural peacemaker.',
                        'Scorpio': 'You possess intense emotional depth and transformative power. Your investigative nature seeks truth beneath the surface.',
                        'Sagittarius': 'Your adventurous spirit and philosophical mind drive you to explore both the world and ideas. Freedom is essential to you.',
                        'Capricorn': 'You are ambitious and disciplined, with a natural ability to build lasting structures. Achievement and responsibility motivate you.',
                        'Aquarius': 'Your innovative mind and humanitarian spirit make you a visionary. You value independence and social progress.',
                        'Pisces': 'You are deeply compassionate and intuitive, with rich inner worlds and artistic sensibilities. Empathy guides your actions.'
                    },
                    moon: {
                        'Aries': 'Your emotional nature is direct and impulsive. You react quickly to situations and need emotional excitement and challenge.',
                        'Taurus': 'You find emotional security in stability and comfort. Your feelings are steady and you need time to process changes.',
                        'Gemini': 'Your emotions are changeable and intellectualized. You need variety and mental stimulation to feel emotionally satisfied.',
                        'Cancer': 'Your emotions run deep and you have strong nurturing instincts. Home and family provide your emotional foundation.',
                        'Leo': 'You have a dramatic emotional nature and need appreciation and recognition. Your feelings are warm and generous.',
                        'Virgo': 'You approach emotions practically and analytically. You find comfort in routine and helping others.',
                        'Libra': 'You seek emotional harmony and balance. Relationships and beauty are essential for your emotional well-being.',
                        'Scorpio': 'Your emotional nature is intense and transformative. You experience feelings deeply and need emotional authenticity.',
                        'Sagittarius': 'You need emotional freedom and adventure. Your feelings are optimistic and you seek meaning in experiences.',
                        'Capricorn': 'You approach emotions cautiously and practically. You need structure and achievement for emotional security.',
                        'Aquarius': 'Your emotional nature is independent and unconventional. You need space and intellectual connection.',
                        'Pisces': 'Your emotions are deeply intuitive and compassionate. You absorb the feelings of others and need creative expression.'
                    },
                    ascendant: {
                        'Aries': 'You appear energetic, confident, and ready for action. Others see you as a natural leader who takes initiative.',
                        'Taurus': 'You appear calm, reliable, and grounded. Others perceive you as stable and someone they can depend on.',
                        'Gemini': 'You appear curious, communicative, and versatile. Others see you as intelligent and socially adaptable.',
                        'Cancer': 'You appear nurturing, sensitive, and protective. Others perceive you as caring and emotionally intuitive.',
                        'Leo': 'You appear confident, charismatic, and creative. Others see you as warm-hearted and naturally dramatic.',
                        'Virgo': 'You appear practical, organized, and helpful. Others perceive you as reliable and detail-oriented.',
                        'Libra': 'You appear charming, diplomatic, and aesthetically aware. Others see you as graceful and fair-minded.',
                        'Scorpio': 'You appear intense, mysterious, and powerful. Others perceive you as magnetic and emotionally deep.',
                        'Sagittarius': 'You appear adventurous, optimistic, and philosophical. Others see you as free-spirited and wise.',
                        'Capricorn': 'You appear serious, ambitious, and responsible. Others perceive you as mature and goal-oriented.',
                        'Aquarius': 'You appear unique, progressive, and independent. Others see you as innovative and humanitarian.',
                        'Pisces': 'You appear gentle, intuitive, and artistic. Others perceive you as compassionate and spiritually aware.'
                    }
                };
            }

            generateInterpretation(planet, sign) {
                const planetKey = planet.toLowerCase();
                if (this.interpretations[planetKey] && this.interpretations[planetKey][sign]) {
                    return this.interpretations[planetKey][sign];
                }
                return `Your ${planet} in ${sign} brings unique energies to your personality and life path.`;
            }
        }

        // Main Application Class
        class NatalChartApp {
            constructor() {
                this.calculator = new NatalChartCalculator();
                this.renderer = new ChartRenderer(document.getElementById('chartSvg'));
                this.interpreter = new InterpretationGenerator();
                this.initializeEventListeners();
                this.setDefaultDate();
            }

            initializeEventListeners() {
                const form = document.getElementById('chartForm');
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.calculateChart();
                });
            }

            setDefaultDate() {
                const today = new Date();
                const dateString = today.toISOString().split('T')[0];
                document.getElementById('birthDate').value = dateString;
                document.getElementById('birthTime').value = '12:00';
            }

            showError(message) {
                const errorDiv = document.getElementById('errorMessage');
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
            }

            hideError() {
                document.getElementById('errorMessage').style.display = 'none';
            }

            showLoading() {
                document.getElementById('loading').style.display = 'block';
            }

            hideLoading() {
                document.getElementById('loading').style.display = 'none';
            }

            validateInputs() {
                const birthDate = document.getElementById('birthDate').value;
                const birthTime = document.getElementById('birthTime').value;
                const birthLocation = document.getElementById('birthLocation').value;

                if (!birthDate) {
                    throw new Error('Please enter your birth date.');
                }
                if (!birthTime) {
                    throw new Error('Please enter your birth time.');
                }
                if (!birthLocation.trim()) {
                    throw new Error('Please enter your birth location.');
                }

                return true;
            }

            parseBirthData() {
                const birthDate = new Date(document.getElementById('birthDate').value + 'T' + document.getElementById('birthTime').value);
                const timezoneOffset = parseFloat(document.getElementById('timezone').value);
                const location = document.getElementById('birthLocation').value;

                // For demo purposes, we'll use approximate coordinates
                // In a real app, you'd use a geocoding service
                const coordinates = this.getApproximateCoordinates(location);

                return {
                    year: birthDate.getFullYear(),
                    month: birthDate.getMonth() + 1,
                    day: birthDate.getDate(),
                    hour: birthDate.getHours(),
                    minute: birthDate.getMinutes(),
                    latitude: coordinates.lat,
                    longitude: coordinates.lng,
                    timezoneOffset: timezoneOffset,
                    location: location
                };
            }

            getApproximateCoordinates(location) {
                // Simplified coordinate lookup - in a real app, use a geocoding API
                const locationMap = {
                    'new york': { lat: 40.7128, lng: -74.0060 },
                    'london': { lat: 51.5074, lng: -0.1278 },
                    'paris': { lat: 48.8566, lng: 2.3522 },
                    'tokyo': { lat: 35.6762, lng: 139.6503 },
                    'sydney': { lat: -33.8688, lng: 151.2093 },
                    'los angeles': { lat: 34.0522, lng: -118.2437 },
                    'chicago': { lat: 41.8781, lng: -87.6298 },
                    'toronto': { lat: 43.6532, lng: -79.3832 },
                    'berlin': { lat: 52.5200, lng: 13.4050 },
                    'rome': { lat: 41.9028, lng: 12.4964 }
                };

                const locationKey = location.toLowerCase().split(',')[0].trim();
                return locationMap[locationKey] || { lat: 40.7128, lng: -74.0060 }; // Default to NYC
            }

            async calculateChart() {
                try {
                    this.hideError();
                    this.validateInputs();
                    this.showLoading();

                    // Simulate calculation delay for better UX
                    await new Promise(resolve => setTimeout(resolve, 1000));

                    const birthData = this.parseBirthData();
                    const chartData = this.calculator.calculateNatalChart(birthData);

                    this.displayResults(chartData, birthData);
                    this.hideLoading();

                } catch (error) {
                    this.hideLoading();
                    this.showError(error.message);
                }
            }

            displayResults(chartData, birthData) {
                // Show results section
                document.getElementById('resultsSection').style.display = 'block';
                
                // Render the chart
                this.renderer.drawChart(chartData);
                
                // Display planet table
                this.displayPlanetTable(chartData.planets);
                
                // Display interpretations
                this.displayInterpretations(chartData, birthData);
                
                // Scroll to results
                document.getElementById('resultsSection').scrollIntoView({ 
                    behavior: 'smooth' 
                });
            }

            displayPlanetTable(planets) {
                const tbody = document.getElementById('planetTableBody');
                tbody.innerHTML = '';

                Object.keys(planets).forEach(planetName => {
                    const planet = planets[planetName];
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td><span class="planet-symbol">${this.calculator.planets[planetName].symbol}</span> ${planetName}</td>
                        <td>${planet.sign.symbol} ${planet.sign.name}</td>
                        <td>${planet.degree.toFixed(1)}°</td>
                        <td>House ${planet.house}</td>
                    `;
                    
                    tbody.appendChild(row);
                });
            }

            displayInterpretations(chartData, birthData) {
                const interpretationsDiv = document.getElementById('interpretations');
                interpretationsDiv.innerHTML = '<h3>Personal Interpretations</h3>';

                // Birth Info Summary
                const birthInfo = document.createElement('div');
                birthInfo.className = 'interpretation-card';
                birthInfo.innerHTML = `
                    <h3>Birth Information</h3>
                    <p><strong>Date:</strong> ${new Date(birthData.year, birthData.month - 1, birthData.day).toLocaleDateString()}</p>
                    <p><strong>Time:</strong> ${birthData.hour.toString().padStart(2, '0')}:${birthData.minute.toString().padStart(2, '0')}</p>
                    <p><strong>Location:</strong> ${birthData.location}</p>
                    <p><strong>Ascendant:</strong> ${chartData.ascendantSign.degree.toFixed(1)}° ${chartData.ascendantSign.sign.name}</p>
                `;
                interpretationsDiv.appendChild(birthInfo);

                // Sun Sign Interpretation
                const sunPlanet = chartData.planets.Sun;
                const sunCard = document.createElement('div');
                sunCard.className = 'interpretation-card';
                sunCard.innerHTML = `
                    <h3>☉ Sun in ${sunPlanet.sign.name} (House ${sunPlanet.house})</h3>
                    <p>${this.interpreter.generateInterpretation('sun', sunPlanet.sign.name)}</p>
                `;
                interpretationsDiv.appendChild(sunCard);

                // Moon Sign Interpretation
                const moonPlanet = chartData.planets.Moon;
                const moonCard = document.createElement('div');
                moonCard.className = 'interpretation-card';
                moonCard.innerHTML = `
                    <h3>☽ Moon in ${moonPlanet.sign.name} (House ${moonPlanet.house})</h3>
                    <p>${this.interpreter.generateInterpretation('moon', moonPlanet.sign.name)}</p>
                `;
                interpretationsDiv.appendChild(moonCard);

                // Ascendant Interpretation
                const ascCard = document.createElement('div');
                ascCard.className = 'interpretation-card';
                ascCard.innerHTML = `
                    <h3>Ascendant in ${chartData.ascendantSign.sign.name}</h3>
                    <p>${this.interpreter.generateInterpretation('ascendant', chartData.ascendantSign.sign.name)}</p>
                `;
                interpretationsDiv.appendChild(ascCard);

                // Additional planetary interpretations
                ['Mercury', 'Venus', 'Mars'].forEach(planetName => {
                    const planet = chartData.planets[planetName];
                    const card = document.createElement('div');
                    card.className = 'interpretation-card';
                    card.innerHTML = `
                        <h3>${this.calculator.planets[planetName].symbol} ${planetName} in ${planet.sign.name} (House ${planet.house})</h3>
                        <p>Your ${planetName} in ${planet.sign.name} influences how you express this planetary energy. Located in House ${planet.house}, it affects this area of your life significantly.</p>
                    `;
                    interpretationsDiv.appendChild(card);
                });

                // Element and Quality Summary
                this.displayElementQualitySummary(chartData.planets, interpretationsDiv);
            }

            displayElementQualitySummary(planets, container) {
                const elements = { Fire: 0, Earth: 0, Air: 0, Water: 0 };
                const qualities = { Cardinal: 0, Fixed: 0, Mutable: 0 };

                Object.values(planets).forEach(planet => {
                    elements[planet.sign.element]++;
                    qualities[planet.sign.quality]++;
                });

                const summaryCard = document.createElement('div');
                summaryCard.className = 'interpretation-card';
                summaryCard.innerHTML = `
                    <h3>Elemental & Quality Balance</h3>
                    <p><strong>Elements:</strong> Fire: ${elements.Fire}, Earth: ${elements.Earth}, Air: ${elements.Air}, Water: ${elements.Water}</p>
                    <p><strong>Qualities:</strong> Cardinal: ${qualities.Cardinal}, Fixed: ${qualities.Fixed}, Mutable: ${qualities.Mutable}</p>
                    <p>This balance shows your fundamental approach to life and how you interact with the world.</p>
                `;
                container.appendChild(summaryCard);
            }
        }

        // Initialize the application when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new NatalChartApp();
        });
    </script>
</body>

</html>
